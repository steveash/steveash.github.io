---
layout: post
title: Building Derby with Eclipse gotcha
date: '2011-03-05T13:46:00.003-06:00'
author: Steve Ash
tags: 
modified_time: '2011-03-05T14:05:07.132-06:00'
blogger_id: tag:blogger.com,1999:blog-4471109663192942674.post-8732917677609773565
blogger_orig_url: http://blog.manycupsofcoffee.com/2011/03/building-derby-with-eclipse-gotcha.html
---

This is partially a reference for myself and for anyone else trying to build Derby 10 from source using Eclipse.  My thesis project involves modifying the on-disk page layout for a database (long story for another post).  I am currently using Eclipse for my IDE.  I just wanted to document a quick pain point in case anyone else is Googling for the answer:<br /><br />I wanted to do a <b>clean build</b> of all of Derby.  So I set up an ANT External Tool launch configuration:<ul><li>Launch the build.xml from the root Derby directory</li><li>Working directory is the root Derby directory</li><li>Refresh resources upon completion</li><li>Uncheck the "build before launch</li><li>Choose the <b>clobber, all</b> targets (clobber is a total clean)</li><li>Defaults for everything else</li></ul><br />I started to build and failed with the follow errors (I'm omitting some of the ones in the middle):<br /><blockquote><br />    [javac] C:\DerbyDev\java\build\org\apache\derbyBuild\javadoc\DiskLayoutTaglet.java:24: package com.sun.tools.doclets does not exist<br />    [javac] import com.sun.tools.doclets.Taglet;<br />    [javac]                             ^<br />    [javac] C:\DerbyDev\java\build\org\apache\derbyBuild\javadoc\DiskLayoutTaglet.java:25: package com.sun.javadoc does not exist<br />    [javac] import com.sun.javadoc.*;<br />    [javac] ^<br /><br />...<br /><br />    [javac] C:\DerbyDev\java\build\org\apache\derbyBuild\javadoc\UpgradeTaglet.java:102: cannot find symbol<br />    [javac] symbol  : class Taglet<br />    [javac] location: class org.apache.derbyBuild.javadoc.UpgradeTaglet<br />    [javac]        Taglet t = (Taglet) tagletMap.get(tag.getName());<br />    [javac]                    ^<br />    [javac] 40 errors<br /></blockquote><br />So as you can see from the first two errors -- its missing the dependency for Javadoc things.  As it turns out Derby defines its own Taglet for Javadoc processing.  All of these classes are defined in the JDKs tools.jar file, which is in the JDK's/lib directory (not included in the JRE).<br /><br />Derby's build script includes tools.jar by: <br />&lt;pathelement path="${java15compile.classpath};${java.home}/../lib/tools.jar"/&gt;<br /><br />Well I went to my command prompt and looked at my environment variable and java_home was set to the JDKs location.  So this should've worked.  I added a new launch configuration to execute the <b>showenv</b> target, and added an echo statement to include java.home.<br /><br />I ran this and low and behold it was pointing to the JRE path, which doesn't have a tools.jar.  So the world made sense now.  In my eclipse installation, I have both the JDK and JRE installations defined in my preferences.  For some reason (subconscious desire to shoot myself in the foot?), the JRE was chosen for this workspace, and thus the launch configuration used that.<br /><br />So to resolve the problem, you can change the external tools launch configuration for the ANT script.  Go to the JRE tab and select <b>separate JRE</b> and choose the JDK.  Or change the default JRE for the workspace, and leave the launch configuration set to <b>run in the same JRE as the workspace</b>.<br /><br />This isn't a tricky problem, but can be a little misleading...plus I haven't posted in a while ;-)